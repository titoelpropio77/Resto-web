<?php/** * DETALLES_MYSQL.class.php * DETALLES **/class DETALLES_MYSQL {	public static $DATABASE_NAME = 'posgourmet';	public static $TABLE_NAME = 'detalles_mysql';public $CONN;	/**	 * @var FACTURA	 */	public $FACTURA ;	/**	 * @var ORDEN	 */	public $ORDEN ;	/**	 * @var ITEM	 */	public $ITEM ;	/**	 * @var COD_PROD	 */	public $COD_PROD ;	/**	 * @var CANTIDAD	 */	public $CANTIDAD ;	/**	 * @var PRE_COSTO	 */	public $PRE_COSTO ;	/**	 * @var PRE_VENTA	 */	public $PRE_VENTA ;	/**	 * @var CAM_OF	 */	public $CAM_OF ;	/**	 * @var F_VENTA	 */	public $F_VENTA ;	/**	 * @var DHORAVEN	 */	public $DHORAVEN ;	/**	 * @var NOM_PROD	 */	public $NOM_PROD ;	/**	 * @var UNIDAD	 */	public $UNIDAD ;	/**	 * @var PENDIENTE	 */	public $PENDIENTE ;	/**	 * @var ANULADO	 */	public $ANULADO ;	/**	 * @var PRESA	 */	public $PRESA ;	/**	 * @var GRUPO	 */	public $GRUPO ;	/**	 * @var CERRADO	 */	public $CERRADO ;	/**	 * @var TURNO	 */	public $TURNO ;	/**	 * @var FAMILIA	 */	public $FAMILIA ;	/**	 * @var UNID	 */	public $UNID ;	/**	 * @var SALIDA	 */	public $SALIDA ;	/**	 * @var FORTAX	 */	public $FORTAX ;	/**	 * @var TOT_DES	 */	public $TOT_DES ;	/**	 * @var FACTOR	 */	public $FACTOR ;	/**	 * @var AGRUPA1	 */	public $AGRUPA1 ;	/**	 * @var AGRUPA2	 */	public $AGRUPA2 ;	/**	 * @var AGRUPA3	 */	public $AGRUPA3 ;	/**	 * @var COD_GRUPO	 */	public $COD_GRUPO ;	/**	 * @var LOGIN	 */	public $LOGIN ;	/**	 * @var ORDENES	 */	public $ORDENES ;	/**	 * @var NOTA	 */	public $NOTA ;	/**	 * @var BARCODE	 */	public $BARCODE ;	/**	 * @var INDICE	 */	public $INDICE ;	/**	 * @var DECONSUMO	 */	public $DECONSUMO ;	public $ID ;function DETALLES_MYSQL($con) {$this->CON=$con;}	function contructor($FACTURA,$ORDEN,$ITEM,$COD_PROD,$CANTIDAD,$PRE_COSTO,$PRE_VENTA,$CAM_OF,$F_VENTA,$DHORAVEN,$NOM_PROD,$UNIDAD,$PENDIENTE,$ANULADO,$PRESA,$GRUPO,$CERRADO,$TURNO,$FAMILIA,$UNID,$SALIDA,$FORTAX,$TOT_DES,$FACTOR,$AGRUPA1,$AGRUPA2,$AGRUPA3,$COD_GRUPO,$LOGIN,$ORDENES,$NOTA,$BARCODE,$INDICE,$DECONSUMO,$ID){	$this->FACTURA=$FACTURA;	$this->ORDEN=$ORDEN;	$this->ITEM=$ITEM;	$this->COD_PROD=$COD_PROD;	$this->CANTIDAD=$CANTIDAD;	$this->PRE_COSTO=$PRE_COSTO;	$this->PRE_VENTA=$PRE_VENTA;	$this->CAM_OF=$CAM_OF;	$this->F_VENTA=$F_VENTA;	$this->DHORAVEN=$DHORAVEN;	$this->NOM_PROD=$NOM_PROD;	$this->UNIDAD=$UNIDAD;	$this->PENDIENTE=$PENDIENTE;	$this->ANULADO=$ANULADO;	$this->PRESA=$PRESA;	$this->GRUPO=$GRUPO;	$this->CERRADO=$CERRADO;	$this->TURNO=$TURNO;	$this->FAMILIA=$FAMILIA;	$this->UNID=$UNID;	$this->SALIDA=$SALIDA;	$this->FORTAX=$FORTAX;	$this->TOT_DES=$TOT_DES;	$this->FACTOR=$FACTOR;	$this->AGRUPA1=$AGRUPA1;	$this->AGRUPA2=$AGRUPA2;	$this->AGRUPA3=$AGRUPA3;	$this->COD_GRUPO=$COD_GRUPO;	$this->LOGIN=$LOGIN;	$this->ORDENES=$ORDENES;	$this->NOTA=$NOTA;	$this->BARCODE=$BARCODE;	$this->INDICE=$INDICE;	$this->DECONSUMO=$DECONSUMO;	$this->ID=$ID;	}function insertar() {     $consulta="INSERT INTO detalles_mysql(FACTURA,ORDEN,ITEM,COD_PROD,CANTIDAD,PRE_COSTO,PRE_VENTA,CAM_OF,F_VENTA,DHORAVEN,NOM_PROD,UNIDAD,PENDIENTE,ANULADO,PRESA,GRUPO,CERRADO,TURNO,FAMILIA,UNID,SALIDA,FORTAX,TOT_DES,FACTOR,AGRUPA1,AGRUPA2,AGRUPA3,COD_GRUPO,LOGIN,ORDENES,NOTA,BARCODE,INDICE,DECONSUMO,ID)values('".$this->FACTURA."','".$this->ORDEN."','".$this->ITEM."','".$this->COD_PROD."','".$this->CANTIDAD."','".$this->PRE_COSTO."','".$this->PRE_VENTA."','".$this->CAM_OF."','".$this->F_VENTA."','".$this->DHORAVEN."','".$this->NOM_PROD."','".$this->UNIDAD."','".$this->PENDIENTE."','".$this->ANULADO."','".$this->PRESA."','".$this->GRUPO."','".$this->CERRADO."','".$this->TURNO."','".$this->FAMILIA."','".$this->UNID."','".$this->SALIDA."','".$this->FORTAX."','".$this->TOT_DES."','".$this->FACTOR."','".$this->AGRUPA1."','".$this->AGRUPA2."','".$this->AGRUPA3."','".$this->COD_GRUPO."','".$this->LOGIN."','".$this->ORDENES."','".$this->NOTA."','".$this->BARCODE."','".$this->INDICE."','".$this->DECONSUMO."','".$this->ID."')"; if (!$this->CON->manipular($consulta))            return 0;        $consulta = "SELECT LAST_INSERT_ID() as id";        $resultado = $this->CON->consulta($consulta);        return $resultado->fetch_assoc()['id'];    }function rellenar($resultado){        if ($resultado->num_rows > 0) {            $lista=array();            while($row = $resultado->fetch_assoc()) {	$detalles_mysql= new DETALLES_MYSQL("");		$detalles_mysql->FACTURA=$row["FACTURA"] ==null?"":$row["FACTURA"];		$detalles_mysql->ORDEN=$row["ORDEN"] ==null?"":$row["ORDEN"];		$detalles_mysql->ITEM=$row["ITEM"] ==null?"":$row["ITEM"];		$detalles_mysql->COD_PROD=$row["COD_PROD"] ==null?"":$row["COD_PROD"];		$detalles_mysql->CANTIDAD=$row["CANTIDAD"] ==null?"":$row["CANTIDAD"];		$detalles_mysql->PRE_COSTO=$row["PRE_COSTO"] ==null?"":$row["PRE_COSTO"];		$detalles_mysql->PRE_VENTA=$row["PRE_VENTA"] ==null?"":$row["PRE_VENTA"];		$detalles_mysql->CAM_OF=$row["CAM_OF"] ==null?"":$row["CAM_OF"];		$detalles_mysql->F_VENTA=$row["F_VENTA"] ==null?"":$row["F_VENTA"];		$detalles_mysql->DHORAVEN=$row["DHORAVEN"] ==null?"":$row["DHORAVEN"];		$detalles_mysql->NOM_PROD=$row["NOM_PROD"] ==null?"":$row["NOM_PROD"];		$detalles_mysql->UNIDAD=$row["UNIDAD"] ==null?"":$row["UNIDAD"];		$detalles_mysql->PENDIENTE=$row["PENDIENTE"] ==null?"":$row["PENDIENTE"];		$detalles_mysql->ANULADO=$row["ANULADO"] ==null?"":$row["ANULADO"];		$detalles_mysql->PRESA=$row["PRESA"] ==null?"":$row["PRESA"];		$detalles_mysql->GRUPO=$row["GRUPO"] ==null?"":$row["GRUPO"];		$detalles_mysql->CERRADO=$row["CERRADO"] ==null?"":$row["CERRADO"];		$detalles_mysql->TURNO=$row["TURNO"] ==null?"":$row["TURNO"];		$detalles_mysql->FAMILIA=$row["FAMILIA"] ==null?"":$row["FAMILIA"];		$detalles_mysql->UNID=$row["UNID"] ==null?"":$row["UNID"];		$detalles_mysql->SALIDA=$row["SALIDA"] ==null?"":$row["SALIDA"];		$detalles_mysql->FORTAX=$row["FORTAX"] ==null?"":$row["FORTAX"];		$detalles_mysql->TOT_DES=$row["TOT_DES"] ==null?"":$row["TOT_DES"];		$detalles_mysql->FACTOR=$row["FACTOR"] ==null?"":$row["FACTOR"];		$detalles_mysql->AGRUPA1=$row["AGRUPA1"] ==null?"0":$row["AGRUPA1"];		$detalles_mysql->AGRUPA2=$row["AGRUPA2"] ==null?"0":$row["AGRUPA2"];		$detalles_mysql->AGRUPA3=$row["AGRUPA3"] ==null?"":$row["AGRUPA3"];		$detalles_mysql->COD_GRUPO=$row["COD_GRUPO"] ==null?"":$row["COD_GRUPO"];		$detalles_mysql->LOGIN=$row["LOGIN"] ==null?"":$row["LOGIN"];		$detalles_mysql->ORDENES=$row["ORDENES"] ==null?"":$row["ORDENES"];		$detalles_mysql->NOTA=$row["NOTA"] ==null?"":$row["NOTA"];		$detalles_mysql->BARCODE=$row["BARCODE"] ==null?"":$row["BARCODE"];		$detalles_mysql->INDICE=$row["INDICE"] ==null?"":$row["INDICE"];		$detalles_mysql->DECONSUMO=$row["DECONSUMO"] ==null?"":$row["DECONSUMO"];		$detalles_mysql->ID=$row["ID"] ==null?"":$row["ID"];		$lista[]=$detalles_mysql;};	return $lista;}	else{            return null;        }}function todo(){        $consulta="select * from detalles_mysql";        $result=$this->CON->consulta($consulta);        return $this->rellenar($result);    }function buscarXID($id){        $consulta="select * from detalles_mysql where ID=".$id;        $result=$this->CON->consulta($consulta);        $detalles_mysql=$this->rellenar($result);        if($detalles_mysql==null){            return null;        }        return $this->rellenar($result);    } function listarDadaVenta($id){   $consulta="select * from detalles_mysql where  detalles_mysql.FACTURA=".$id;        $result=$this->CON->consulta($consulta);        $detalles_mysql=$this->rellenar($result);        if($detalles_mysql==null){            return null;        }        return  $detalles_mysql; } function listarDadaVentaNoAnuladas($id){   $consulta="select * from detalles_mysql where ANULADO='' and  detalles_mysql.FACTURA=".$id;        $result=$this->CON->consulta($consulta);        $detalles_mysql=$this->rellenar($result);        if($detalles_mysql==null){            return null;        }        return  $detalles_mysql; } function listarPrintCocina($id){ 	 $consulta="SELECT *, detalles_mysql.NOM_PROD, detalles_mysql.CANTIDAD FROM detalles_mysql,productos_mysql WHERE detalles_mysql.COD_PROD=productos_mysql.id and  detalles_mysql.FACTURA=".$id." and productos_mysql.impcoc<>''   ORDER by  detalles_mysql.ITEM asc"; 	  // $consulta="SELECT *, detalles_mysql.NOM_PROD, detalles_mysql.CANTIDAD FROM ven_gral_mysql,detalles_mysql,productos_mysql WHERE detalles_mysql.COD_PROD=productos_mysql.id and ven_gral_mysql.ID=detalles_mysql.FACTURA and ven_gral_mysql.FACTURA=".$id." and productos_mysql.impcoc<>''   ORDER by  detalles_mysql.ITEM asc";        $result=$this->CON->consulta($consulta);        $detalles_mysql=$this->rellenar($result);        if($detalles_mysql==null){            return "";        }        return $detalles_mysql; } function listarPrintPunto($id,$index){ 	  $consulta="SELECT *, detalles_mysql.NOM_PROD,detalles_mysql.CANTIDAD FROM detalles_mysql,productos_mysql WHERE detalles_mysql.COD_PROD=productos_mysql.id  and  detalles_mysql.FACTURA=".$id." and productos_mysql.imppunt".$index."<>''    ORDER by  detalles_mysql.ITEM asc"; 	  // $consulta="SELECT *, detalles_mysql.NOM_PROD,detalles_mysql.CANTIDAD FROM ven_gral_mysql,detalles_mysql,productos_mysql WHERE detalles_mysql.COD_PROD=productos_mysql.id  and ven_gral_mysql.ID=detalles_mysql.FACTURA and ven_gral_mysql.FACTURA=".$id." and productos_mysql.imppunt".$index."<>''    ORDER by  detalles_mysql.ITEM asc";        $result=$this->CON->consulta($consulta);        $detalles_mysql=$this->rellenar($result);        if($detalles_mysql==null){            return "";        }        return $detalles_mysql; }function listarDadaFecha($fecha,$entrada,$vendedor){		switch ($entrada) {		case 'LOS2TURNOS':			if ($vendedor=="") {				 $consulta="SELECT FACTURA,ORDEN,ITEM,COD_PROD,SUM(CANTIDAD) as CANTIDAD,PRE_COSTO,PRE_VENTA,CAM_OF,F_VENTA,DHORAVEN,NOM_PROD,UNIDAD,PENDIENTE,ANULADO,PRESA,GRUPO,CERRADO,TURNO,FAMILIA,UNID,SALIDA,FORTAX,TOT_DES,FACTOR,SUM(AGRUPA1) AS AGRUPA1,sum(AGRUPA2) as AGRUPA2,sum(AGRUPA3) as AGRUPA3,COD_GRUPO,LOGIN,ORDENES,NOTA,BARCODE,INDICE,DECONSUMO,ID FROM detalles_mysql WHERE  detalles_mysql.F_VENTA='".$fecha."' and  detalles_mysql.ANULADO <>'S' GROUP by NOM_PROD ORDER BY detalles_mysql.INDICE ASC,detalles_mysql.NOM_PROD ASC";			}else{			 $consulta="SELECT FACTURA,ORDEN,ITEM,COD_PROD,SUM(CANTIDAD) as CANTIDAD,PRE_COSTO,PRE_VENTA,CAM_OF,F_VENTA,DHORAVEN,NOM_PROD,UNIDAD,PENDIENTE,ANULADO,PRESA,GRUPO,CERRADO,TURNO,FAMILIA,UNID,SALIDA,FORTAX,TOT_DES,FACTOR,SUM(AGRUPA1) AS AGRUPA1,sum(AGRUPA2) as AGRUPA2,sum(AGRUPA3) as AGRUPA3,COD_GRUPO,LOGIN,ORDENES,NOTA,BARCODE,INDICE,DECONSUMO,ID FROM detalles_mysql WHERE detalles_mysql.LOGIN='".$vendedor."' and  detalles_mysql.ANULADO <>'S' and detalles_mysql.F_VENTA='".$fecha."' GROUP by NOM_PROD ORDER BY detalles_mysql.INDICE ASC,detalles_mysql.NOM_PROD ASC";			}			break;		case 'TURNOMAÑANA':			if ($vendedor=="") {			 $consulta="SELECT FACTURA,ORDEN,ITEM,COD_PROD,SUM(CANTIDAD) as CANTIDAD,PRE_COSTO,PRE_VENTA,CAM_OF,F_VENTA,DHORAVEN,NOM_PROD,UNIDAD,PENDIENTE,ANULADO,PRESA,GRUPO,CERRADO,TURNO,FAMILIA,UNID,SALIDA,FORTAX,TOT_DES,FACTOR,SUM(AGRUPA1) AS AGRUPA1,sum(AGRUPA2) as AGRUPA2,sum(AGRUPA3) as AGRUPA3,COD_GRUPO,LOGIN,ORDENES,NOTA,BARCODE,INDICE,DECONSUMO,ID  FROM detalles_mysql WHERE detalles_mysql.F_VENTA='".$fecha."' and  detalles_mysql.ANULADO <>'S' and TURNO='MAÑANA' GROUP by NOM_PROD ORDER BY detalles_mysql.INDICE ASC,detalles_mysql.NOM_PROD ASC";			}else{				$consulta="SELECT FACTURA,ORDEN,ITEM,COD_PROD,SUM(CANTIDAD) as CANTIDAD,PRE_COSTO,PRE_VENTA,CAM_OF,F_VENTA,DHORAVEN,NOM_PROD,UNIDAD,PENDIENTE,ANULADO,PRESA,GRUPO,CERRADO,TURNO,FAMILIA,UNID,SALIDA,FORTAX,TOT_DES,FACTOR,SUM(AGRUPA1) AS AGRUPA1,sum(AGRUPA2) as AGRUPA2,sum(AGRUPA3) as AGRUPA3,COD_GRUPO,LOGIN,ORDENES,NOTA,BARCODE,INDICE,DECONSUMO,ID  FROM detalles_mysql WHERE detalles_mysql.LOGIN='".$vendedor."' and  detalles_mysql.ANULADO <>'S' and detalles_mysql.F_VENTA='".$fecha."' and TURNO='MAÑANA' GROUP by NOM_PROD ORDER BY detalles_mysql.INDICE ASC,detalles_mysql.NOM_PROD ASC";			}			break;			case 'TURNONOCHE':			if ($vendedor=="") {				 $consulta="SELECT FACTURA,ORDEN,ITEM,COD_PROD,SUM(CANTIDAD) as CANTIDAD,PRE_COSTO,PRE_VENTA,CAM_OF,F_VENTA,DHORAVEN,NOM_PROD,UNIDAD,PENDIENTE,ANULADO,PRESA,GRUPO,CERRADO,TURNO,FAMILIA,UNID,SALIDA,FORTAX,TOT_DES,FACTOR,SUM(AGRUPA1) AS AGRUPA1,sum(AGRUPA2) as AGRUPA2,sum(AGRUPA3) as AGRUPA3,COD_GRUPO,LOGIN,ORDENES,NOTA,BARCODE,INDICE,DECONSUMO,ID  FROM detalles_mysql WHERE detalles_mysql.F_VENTA='".$fecha."' and  detalles_mysql.ANULADO <>'S' and TURNO='NOCHE' GROUP by NOM_PROD ORDER BY detalles_mysql.INDICE ASC,detalles_mysql.NOM_PROD ASC";			}else{				 $consulta="SELECT FACTURA,ORDEN,ITEM,COD_PROD,SUM(CANTIDAD) as CANTIDAD,PRE_COSTO,PRE_VENTA,CAM_OF,F_VENTA,DHORAVEN,NOM_PROD,UNIDAD,PENDIENTE,ANULADO,PRESA,GRUPO,CERRADO,TURNO,FAMILIA,UNID,SALIDA,FORTAX,TOT_DES,FACTOR,SUM(AGRUPA1) AS AGRUPA1,sum(AGRUPA2) as AGRUPA2,sum(AGRUPA3) as AGRUPA3,COD_GRUPO,LOGIN,ORDENES,NOTA,BARCODE,INDICE,DECONSUMO,ID  FROM detalles_mysql WHERE detalles_mysql.LOGIN='".$vendedor."' and  detalles_mysql.ANULADO <>'S' and detalles_mysql.F_VENTA='".$fecha."' and TURNO='NOCHE' GROUP by NOM_PROD ORDER BY detalles_mysql.INDICE ASC,detalles_mysql.NOM_PROD ASC";			}								break;		default:			# code...			break;	}		 $result=$this->CON->consulta($consulta);        $detalles_mysql=$this->rellenar($result);        if($detalles_mysql==null){            return "";        }        return $detalles_mysql;}function archivarTotales($fecha,$entrada,$empleado){	switch ($entrada) {		case 'LOS2TURNOS':			if ($empleado=="") {				$consulta="update detalles_mysql				set CERRADO='S' WHERE F_VENTA='".$fecha."'";			}else{			 $consulta="update detalles_mysql				set CERRADO='S' WHERE F_VENTA='".$fecha."' and LOGIN='$empleado'";			}			break;		case 'TURNOMAÑANA':			if ($empleado=="") {				$consulta="update detalles_mysql				set CERRADO='S' WHERE F_VENTA='".$fecha."' and TURNO='MAÑANA'";			}else{			 $consulta="update detalles_mysql				set CERRADO='S' WHERE F_VENTA='".$fecha."' and TURNO='MAÑANA' and LOGIN='$empleado'";			}			break;			case 'TURNONOCHE':			if ($empleado=="") {				$consulta="update detalles_mysql				set CERRADO='S' WHERE F_VENTA='".$fecha."' and TURNO='NOCHE'";			}else{			 $consulta="update detalles_mysql				set CERRADO='S' WHERE F_VENTA='".$fecha."' and TURNO='NOCHE' and LOGIN='$empleado'";			}				break;		default:			# code...			break;	}		 return $this->CON->manipular($consulta);}function todoDadaDosFecha($fechaInicial,$fechaFin){		 $consulta='select FACTURA,ORDEN,ITEM,COD_PROD,sum(CANTIDAD) as CANTIDAD,PRE_COSTO,PRE_VENTA,CAM_OF,F_VENTA,DHORAVEN,NOM_PROD,UNIDAD,PENDIENTE,ANULADO,PRESA,GRUPO,CERRADO,TURNO,FAMILIA,UNID,SALIDA,FORTAX,TOT_DES,FACTOR,SUM(AGRUPA1)AS AGRUPA1,AGRUPA2,SUM(AGRUPA3)AS AGRUPA3,COD_GRUPO,LOGIN,ORDENES,NOTA,BARCODE,INDICE,DECONSUMO,ID from detalles_mysql where detalles_mysql.F_VENTA BETWEEN  "'.$fechaInicial.'"  and "'.$fechaFin.'"  AND ANULADO<>"S" GROUP BY  NOM_PROD '; 	$result=$this->CON->consulta($consulta);        $ven_gral_mysql=$this->rellenar($result);        if($ven_gral_mysql==null){            return $ven_gral_mysql="";        }        return $ven_gral_mysql; 	}function contadoCreditoDadaDosFecha($fechaInicial,$fechaFin){	$consulta='select FACTURA,ORDEN,ITEM,COD_PROD,sum(CANTIDAD) as CANTIDAD,PRE_COSTO,PRE_VENTA,CAM_OF,F_VENTA,DHORAVEN,NOM_PROD,UNIDAD,PENDIENTE,ANULADO,PRESA,GRUPO,CERRADO,TURNO,FAMILIA,UNID,SALIDA,FORTAX,TOT_DES,FACTOR,SUM(AGRUPA1)AS AGRUPA1,AGRUPA2,SUM(AGRUPA3)AS AGRUPA3,COD_GRUPO,LOGIN,ORDENES,NOTA,BARCODE,INDICE,DECONSUMO,ID from detalles_mysql where detalles_mysql.FAMILA="CONTADO"  AND detalles_mysql.FAMILA="CREDITO" AND ANULADO<>"S" AND  detalles_mysql.F_VENTA BETWEEN  "'.$fechaInicial.'"  and "'.$fechaFin.'" GROUP BY  NOM_PROD'; 	$result=$this->CON->consulta($consulta);        $ven_gral_mysql=$this->rellenar($result);        if($ven_gral_mysql==null){            return $ven_gral_mysql="";        }        return $ven_gral_mysql; }function formaPago($fechaInicial,$fechaFin,$tipoPago){	 $consulta='select FACTURA,ORDEN,ITEM,COD_PROD,sum(CANTIDAD) as CANTIDAD,PRE_COSTO,PRE_VENTA,CAM_OF,F_VENTA,DHORAVEN,NOM_PROD,UNIDAD,PENDIENTE,ANULADO,PRESA,GRUPO,CERRADO,TURNO,FAMILIA,UNID,SALIDA,FORTAX,TOT_DES,FACTOR,SUM(AGRUPA1) AS AGRUPA1,AGRUPA2,SUM(AGRUPA3)AS AGRUPA3,COD_GRUPO,LOGIN,ORDENES,NOTA,BARCODE,INDICE,DECONSUMO,ID from detalles_mysql where detalles_mysql.FAMILIA="'.$tipoPago.'" AND ANULADO<>"S" AND  detalles_mysql.F_VENTA BETWEEN  "'.$fechaInicial.'"  and "'.$fechaFin.'" GROUP BY  NOM_PROD'; 	$result=$this->CON->consulta($consulta);        $ven_gral_mysql=$this->rellenar($result);        if($ven_gral_mysql==null){            return $ven_gral_mysql="";        }        return $ven_gral_mysql; }function listarReporteServicioDada2Fechas($fechaInicial,$fechaFinal){ $consulta="select *,sum(CANTIDAD)as CANTIDAD,SUBSTRING(SALIDA,1,4) AS SALIDAfrom detalles_mysql WHERE detalles_mysql.F_VENTA  BETWEEN  '".$fechaInicial."'  and '".$fechaFinal."'  and  detalles_mysql.ANULADO <>'S'GROUP BY NOM_PROD,SUBSTRING(SALIDA,1,4) ORDER BY SUBSTRING(SALIDA,1,4)";$result=$this->CON->consulta($consulta);$ven_gral_mysql=$this->rellenar($result);        if($ven_gral_mysql==null){            return $ven_gral_mysql="";        }return $ven_gral_mysql; }function anularVenta($id,$opcion){	 $consulta="update detalles_mysql		set ANULADO='$opcion'		WHERE FACTURA=$id";return $this->CON->manipular($consulta);}function modificarIndice($idProducto,$indice){$consulta="update detalles_mysql		set INDICE='$indice'		WHERE COD_PROD=$idProducto";return $this->CON->manipular($consulta);}}